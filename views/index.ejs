<!DOCTYPE html>
<html ng-app="webapp">
<head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script type="text/javascript" src="bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="bower_components/angular/angular.js"></script>
    <script type="text/javascript" src="javascripts/webapp.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script>
        var apikey = "up3wv3uvufs74w5yqh2tdpza";
        var baseUrl = "http://api.rottentomatoes.com/api/public/v1.0";
        // construct the uri with our apikey
        var moviesSearchUrl = baseUrl + '/movies.json?apikey=' + apikey;
        var query = "Boyhood";
        $(document).ready(function() {
            // send off the query
            $.ajax({
                url: moviesSearchUrl + '&q=' + encodeURI(query),
                dataType: "jsonp",
                success: searchCallback
            });
        });
        // callback for when we get back the results
        function searchCallback(data) {
            var movies = data.movies;
            var movie = $(movies).first()[0];
            //console.log($(movies).first()[0].title);
            $("div.movie-title").text(movie.title);
            $("img.poster-image").attr("src", movie.posters.detailed);
            $("div.movie-rating2").text("%" + movie.ratings.critics_score);
            console.log(movie.posters.original);
        }
    </script>

</head>
<body ng-controller="webController as ctrl">
<div class="page-container">

    <div ng-init='poster=true' class="movie-container">
        <div ng-show="true" class="poster">
            <!--<div class="title-container">-->
            <!--<div class="movie-title">Gamer</div>-->
            <!--<div class="movie-rating">-->
            <!--<img src="images/tomato.png"/>-->
            <!--<div>34%</div>-->
            <!--</div>-->
            <!--</div>-->
            <div class="poster-container">
                <div class="movie-title title-container"></div>
                <div class="movie-rating2"></div>
                <img class="movie-rating-tomato" src="images/tomato.png"/>
                <img class="poster-image" src="images/poster1.png"/>
            </div>
            <!--<div class="poster-img"></div>-->
        </div>
        <div ng-show="false" class="trailer">

        </div>
    </div>
</div>
<script type="text/javascript" src="bower_components/imagesloaded/imagesloaded.pkgd.js"></script>
<script type="text/javascript" src="bower_components/jquery-fillcontainer/jquery.fillcontainer.js"></script>
<script type="text/javascript">
    $(function() {
        imagesLoaded('.poster-container', function() {
            $('.poster-container').fillContainer({
                fillMode: 'fit',
                parent: '.movie-container'
            });
            console.log( "ready!" );
        });
    });

</script>
</body>
</html>
